# 🚗 配送料金算出システム

郵便番号986-0814（宮城県石巻市）から任意の配送先までの車両配送料金を自動計算するWebアプリケーションです。

## 📋 機能概要

### 計算内容
- **人件費**: 往復時間 × 時給 × 2人
- **ガソリン代**: 往復距離 ÷ 8km/L × ガソリン単価（スタッフ車のみ）
- **高速道路料金**: 往路2台分 + 復路1台分
- **利益**: 直接経費 × 利益率
- **配送料金**: 直接経費 + 利益

### デフォルト設定（随時変更可能）
- ガソリン単価: 167円/L
- 時給: 1,300円/時
- 利益率: 25%

### 前提条件
- 出発地: 〒986-0814（宮城県石巻市南光町2丁目）
- 配送車両: 2台（配送車 + スタッフ車）
- 配送人数: 2人（固定）
- 高速道路使用: あり
- 燃費: 8km/L

## 🚀 使い方

### 1. サーバーの起動

```bash
# Pythonで起動（Python 3が必要）
python3 server.py
```

または

```bash
# 実行権限を付与して起動
chmod +x server.py
./server.py
```

### 2. ブラウザでアクセス

サーバー起動後、以下のURLにアクセスしてください：

```
http://localhost:8000
```

### 3. 料金計算

1. 必要に応じて設定値を変更（ガソリン単価、時給、利益率）
2. 配送先の郵便番号を入力（例: 100-0001）
3. 「料金を計算」ボタンをクリック
4. 配送料金の詳細が表示されます

## 📊 計算ロジック

### 距離・時間の算出
- OpenStreetMap Nominatim APIを使用して住所から座標を取得
- Haversine公式で直線距離を計算
- 道路距離 = 直線距離 × 1.3（係数）
- 所要時間 = 道路距離 ÷ 80km/h（高速道路平均速度）

### 高速道路料金
- 普通車・ETC料金で計算
- 概算: 24.6円/km（全国平均）
- 往路2台分 + 復路1台分 = 片道料金 × 3

### 費用計算式

```
配送料金 = 直接経費 + 利益

直接経費 = 人件費 + ガソリン代 + 高速道路料金
利益 = 直接経費 × 利益率

人件費 = 往復時間(h) × 時給 × 2人
ガソリン代 = 往復距離(km) ÷ 8 × ガソリン単価
高速道路料金 = 片道距離(km) × 24.6円 × 3
```

## 🛠️ 技術仕様

### フロントエンド
- HTML5
- CSS3（レスポンシブデザイン）
- Vanilla JavaScript（依存ライブラリなし）

### API使用
- **郵便番号検索**: zipcloud API（無料）
- **座標取得**: OpenStreetMap Nominatim API（無料）

### ファイル構成

```
webapp/
├── index.html      # メインHTML
├── style.css       # スタイルシート
├── script.js       # JavaScript（計算ロジック）
├── server.py       # 開発用サーバー
└── README.md       # このファイル
```

## ⚠️ 注意事項

1. **料金の精度**
   - 高速道路料金は概算値です
   - 実際の料金は路線や時間帯により変動します
   - より正確な料金が必要な場合は、NEXCO料金検索をご利用ください

2. **距離・時間の計算**
   - 直線距離から道路距離を推定しています
   - 実際のルートとは異なる場合があります
   - 交通状況は考慮されていません

3. **API制限**
   - 使用しているAPIには利用制限があります
   - 短時間での大量リクエストは避けてください

## 🔧 カスタマイズ

### 設定の変更

画面上の設定セクションで以下の値を随時変更できます：

- **ガソリン単価**: 100〜300円/L（デフォルト: 167円）
- **時給**: 1,000〜5,000円/時（デフォルト: 1,300円）
- **利益率**: 0〜100%（デフォルト: 25%）

その他の固定値は`script.js`で変更できます：

```javascript
const NUM_WORKERS = 2;              // 作業人数
const FUEL_EFFICIENCY = 8;          // 燃費（km/L）
const HIGHWAY_COST_PER_KM = 24.6;   // 高速料金（円/km）
```

## 📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🤝 サポート

問題が発生した場合は、以下を確認してください：

1. Python 3がインストールされているか
2. ポート8000が使用可能か
3. インターネット接続が有効か（API使用のため）
4. ブラウザのJavaScriptが有効か

---

**開発**: 2024年
**バージョン**: 1.0.0
